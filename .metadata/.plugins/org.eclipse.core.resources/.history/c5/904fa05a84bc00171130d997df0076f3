package composite.order.service;

import composite.order.model.Order;

public class OrderCompositeIntegration {

	private static final Logger LOG = LoggerFactory.getLogger(ProductCompositeIntegration.class);
	
	@Autowired
	Util util;
	
	private RestTemplate restTemplate = new RestTemplate();
	
	public ResponseEntity<Product> getOrder(long orderId) {

        URI uri = util.getServiceUrl("order-service", "http://localhost:8081/product");
        String url = uri.toString() + "/order/" + orderId;
        LOG.debug("Getting Order from URL: {}", url);

        ResponseEntity<String> resultStr = restTemplate.getForEntity(url, String.class);
        LOG.debug("Get Order http-status: {}", resultStr.getStatusCode());
        LOG.debug("Get Order body: {}", resultStr.getBody());

        Order order = util.response2Order(resultStr);
        LOG.debug("GetOrder.id: {}", Order.getOrderId());

        return util.createOkResponse(order);
    }
}
